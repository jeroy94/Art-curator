{% extends "base.html" %}

{% block head %}
{{ super() }}
<style>
    @media print {
        body * {
            visibility: hidden;
        }
        #print-section, #print-section * {
            visibility: visible;
        }
        #print-section {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
        }
        .cartel-page {
            page-break-after: always;
        }
    }

    @page {
        size: A4;
        margin: 5mm;
    }

    .cartel-page {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: flex-start;
        page-break-inside: avoid;
    }

    .cartel-container {
        font-family: 'Arial', sans-serif;
        width: 100mm;
        height: 50mm;
        margin: 2mm;
        padding: 5mm;
        border: 5px solid black;  /* Bordure TRÈS visible */
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
        position: relative;
    }

    .cartel-container::before,
    .cartel-container::after {
        content: '';
        position: absolute;
        left: -5px;
        right: -5px;
        height: 5px;
        background-color: black;
    }

    .cartel-container::before {
        top: -5px;
    }

    .cartel-container::after {
        bottom: -5px;
    }

    .cartel-artist {
        font-size: 10pt;
        font-weight: bold;
        color: #000;
        margin-bottom: 2mm;
        text-transform: uppercase;
    }

    .cartel-artwork-title {
        font-size: 9pt;
        font-style: italic;
        color: #333;
        margin-bottom: 2mm;
        margin: 3mm 0;
    }

    .cartel-metadata {
        font-size: 8pt;
        color: #666;
        line-height: 1.4;
        font-size: 9pt;
    }

    @media print {
        .cartel-container {
            -webkit-print-color-adjust: exact !important;
            color-adjust: exact !important;
        }
    }

    /* Debug style pour visualiser les bordures */
    .debug-border {
        border: 3px solid red !important;
    }
</style>
{% endblock %}

{% block content %}
<div id="print-section">
    {% for artist in artists %}
        <div class="cartel-page">
            {% for artwork in artist.artworks if artwork.statut == 'selectionne' %}
            <div class="cartel-container">
                <div class="cartel-artist">{{ artist.nom|upper }} {{ artist.prenom|upper }}</div>
                <div class="cartel-artwork-title">{{ artwork.titre }}</div>
                <div class="cartel-metadata">
                    <p>Technique : {{ artwork.technique or 'Non spécifiée' }}</p>
                    <p>Dimensions : 
                        {{ artwork.dimension_largeur or '?' }}x{{ artwork.dimension_hauteur or '?' }}{% if artwork.dimension_profondeur %}x{{ artwork.dimension_profondeur or '?' }}{% endif %} cm
                    </p>
                </div>
            </div>
            {% if loop.index % 2 == 0 %}
                <div style="width: 100%; height: 0; page-break-before: always;"></div>
            {% endif %}
            {% endfor %}
        </div>
    {% endfor %}
</div>

<script>
    window.onload = function() {
        // Option de débogage : ajouter une bordure rouge visible
        // Décommentez la ligne suivante si vous ne voyez toujours pas de bordure
        // document.querySelectorAll('.cartel-container').forEach(el => el.classList.add('debug-border'));
        
        window.print();
    }
</script>
{% endblock %}
